Android 系统架构分为五层，从上到下依次是
应用层、应用框架层、系统运行库层、硬件抽象层和Linux 内核层，

 <img src=".\images\android-stack_2x.png" style="zoom:50%;" />

## 1. 应用层（ System Apps)
   系统内置的应用程序以及非系统级的应用程序都属于应用层，负责与用户进行直接交
   互，通常都是用Java 进行开发的。
## 2. 应用框架层（ Java API Framework)
   应用框架层为开发人员提供了开发应用程序所需要的API ，我们平常开发应用程序都
   是调用这一层所提供的API ，当然也包括系统应用。这一层是由Java 代码编写的，可以称
   为Java Framework。

| Activity Manager （活动管理器）     | 管理各个应用程序生命周期，以及常用的导航回退功能             |
| ----------------------------------- | ------------------------------------------------------------ |
| Window Manager （窗口管理器）       | 管理所有开启的窗口程序                                       |
| Location Manager （位置管理器）     | 提供地理位置及定位功能服务                                   |
| Package Manager （包管理器          | 管理所有安装在Android 系统中的应用程序                       |
| Notification Manager （通知管理器） | 使得应用程序可以在状态栏中显示自定义的提示信息               |
| Resource Manager （资源管理器）     | 提供应用程序使用的各种非代码资源，女日本地化字符串、图片、布局文件、颜色文件等 |
| Telephony Manager （电话管理器）    | 管理所有的移动设备功能                                       |
| Content Provider （内容提供器）     | 使得不同应用程序之间可以共享数据                             |
| View System （视图系统）            | 构建应用程序的基本组件                                       |

## 3. 系统运行库层（ Native)

###  1) C/C ＋＋程序库
   C/C ＋＋ 程序库能被Android 系统中的不同组件所使用，井通过应用程序框架为开发者提
   供服务

###  2 ）Android 运行时库
   运行时库又分为`核心库和ART` (Android 5.0 系统之后， Dalvik 虚拟机被ART 取代）。核心库提供了Java 语言核心库的大多数功能，这样开发者可以使用Java 语言来编写Android 应用。

* Dalvik 虚拟机（ DVM ）是专门为移动设备定制的， 允许在有限的内存中同时运行多个虚拟机的实例，并且每一个Dalvik 应用作为一个独立的    Linux 进程执行。独立的进程可以防止在虚拟机崩攒的时候所有程序都被关闭。

* 而 ART 的机制与DVM 不同， DVM 中的应用每次运行时，字节码都需要通过即时编译器(Just In Time ，且T ）转换为机器码，这会使得应用的运行效率降低。而在ART 中，系统在安装应用时会进行一次预编译（ Ahead Of Time, AOT ），将字节码预先编译成机器码并存储在本地，这样应用每次运行时就不需要执行编译了，运行效率也大大提高。

## 4. 硬件抽象层（ HAL)
硬件抽象层是位于操作系统内核与硬件电路之间的接口层，其目的在于将硬件抽象化，为了保护硬件厂商的知识产权，它隐藏了特定平台的硬件接口细节，为操作系统提供虚拟硬件平台，使其具有硬件无关性，可在多种平台上进行移植。从软硬件测试的角度来看，软硬件的测试工作者H可分别基于硬件抽象层未完成，使得软硬件测试工作的并行进行成为可能。通俗来讲，就是将控制硬件的动作放在硬件抽象层中。

## 5. Linux 内核层C Linux Kernel)
   Android 的核心系统服务基于Linux 内核，在此基础上添加了部分Android 专用的驱动。系统的安全性、内存管理、进程管理、网络协议技和驱动模型等都依赖于该内核。

### 1.2 Android 系统源码目录

![image-20221020144755479](.\images\image-20221020144755479.png)

![image-20221020144820229](.\images\image-20221020144820229.png)

### 1.2.2 应用层部分

![image-20221020151622415](.\images\image-20221020151622415.png)

![image-20221020151705357](.\images\image-20221020151705357.png)

### 1.2.3 应用框架层部分

应用框架层是系统的核心部分，一方面向上提供接口给应用层调用，另一方面向下与
C/C＋＋程序库及硬件抽象层等进行衔接。应用框架层的主要实现代码在frameworks/base 和
企ameworks/av 目录下

![image-20221020151748823](.\images\image-20221020151748823.png)



